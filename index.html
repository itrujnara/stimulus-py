<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://mathysgrapotte.github.io/stimulus-py/ rel=canonical><link href=changelog/ rel=next><link rel=icon href=assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.50"><title>Overview - stimulus-py</title><link rel=stylesheet href=assets/stylesheets/main.a40c8224.min.css><link rel=stylesheet href=assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=assets/_markdown_exec_pyodide.css><link rel=stylesheet href=css/timeago.css><link rel=stylesheet href=assets/_mkdocstrings.css><link rel=stylesheet href=css/material.css><link rel=stylesheet href=css/mkdocstrings.css><script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#stimulus class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=. title=stimulus-py class="md-header__button md-logo" aria-label=stimulus-py data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> stimulus-py </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Overview </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=lime aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/mathysgrapotte/stimulus-py title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> mathysgrapotte/stimulus-py </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class="md-tabs__item md-tabs__item--active"> <a href=. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=reference/stimulus/ class=md-tabs__link> API reference </a> </li> <li class=md-tabs__item> <a href=contributing/ class=md-tabs__link> Development </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=. title=stimulus-py class="md-nav__button md-logo" aria-label=stimulus-py data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> stimulus-py </label> <div class=md-nav__source> <a href=https://github.com/mathysgrapotte/stimulus-py title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> mathysgrapotte/stimulus-py </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1 checked> <div class="md-nav__link md-nav__container"> <a href=. class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Home </span> </a> <label class="md-nav__link md-nav__link--active" for=__nav_1 id=__nav_1_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=changelog/ class=md-nav__link> <span class=md-ellipsis> Changelog </span> </a> </li> <li class=md-nav__item> <a href=credits/ class=md-nav__link> <span class=md-ellipsis> Credits </span> </a> </li> <li class=md-nav__item> <a href=license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> API reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> API reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> stimulus-py </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> stimulus-py </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> stimulus </span> </a> <label class="md-nav__link " for=__nav_2_1_1 id=__nav_2_1_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_2_1_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> stimulus </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_2> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/analysis/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> analysis </span> </a> <label class="md-nav__link " for=__nav_2_1_1_2 id=__nav_2_1_1_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_1_1_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_2> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=reference/stimulus/analysis/analysis_default/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> analysis_default </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_3> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/cli/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> cli </span> </a> <label class="md-nav__link " for=__nav_2_1_1_3 id=__nav_2_1_1_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_1_1_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_3> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> cli </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=reference/stimulus/cli/analysis_default/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> analysis_default </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/cli/check_model/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> check_model </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/cli/predict/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> predict </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/cli/shuffle_csv/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> shuffle_csv </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/cli/split_csv/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> split_csv </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/cli/split_yaml/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> split_yaml </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/cli/transform_csv/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> transform_csv </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/cli/tuning/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> tuning </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_4> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/data/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> data </span> </a> <label class="md-nav__link " for=__nav_2_1_1_4 id=__nav_2_1_1_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_1_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_4> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=reference/stimulus/data/data_handlers/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> data_handlers </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_4_3> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/data/encoding/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> encoding </span> </a> <label class="md-nav__link " for=__nav_2_1_1_4_3 id=__nav_2_1_1_4_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_1_1_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_4_3> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> encoding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=reference/stimulus/data/encoding/encoders/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> encoders </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=reference/stimulus/data/handlertorch/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> handlertorch </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/data/loaders/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> loaders </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_4_6> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/data/splitters/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> splitters </span> </a> <label class="md-nav__link " for=__nav_2_1_1_4_6 id=__nav_2_1_1_4_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_1_1_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_4_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> splitters </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=reference/stimulus/data/splitters/splitters/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> splitters </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_4_7> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/data/transform/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> transform </span> </a> <label class="md-nav__link " for=__nav_2_1_1_4_7 id=__nav_2_1_1_4_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_2_1_1_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_4_7> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> transform </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=reference/stimulus/data/transform/data_transformation_generators/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> data_transformation_generators </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=reference/stimulus/debug/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> debug </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_6> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/learner/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> learner </span> </a> <label class="md-nav__link " for=__nav_2_1_1_6 id=__nav_2_1_1_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_1_1_6_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> learner </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=reference/stimulus/learner/predict/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> predict </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/learner/raytune_learner/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> raytune_learner </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/learner/raytune_parser/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> raytune_parser </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=reference/stimulus/typing/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> typing </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1_1_8> <div class="md-nav__link md-nav__container"> <a href=reference/stimulus/utils/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> utils </span> </a> <label class="md-nav__link " for=__nav_2_1_1_8 id=__nav_2_1_1_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_2_1_1_8_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1_1_8> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=reference/stimulus/utils/generic_utils/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> generic_utils </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/utils/launch_utils/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> launch_utils </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/utils/performance/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> performance </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/utils/yaml_data/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> yaml_data </span> </a> </li> <li class=md-nav__item> <a href=reference/stimulus/utils/yaml_model_schema/ class=md-nav__link> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> yaml_model_schema </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Development </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=code_of_conduct/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> <li class=md-nav__item> <a href=coverage/ class=md-nav__link> <span class=md-ellipsis> Coverage report </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#stochastic-testing-with-input-modification-for-unbiased-learning-systems class=md-nav__link> <span class=md-ellipsis> Stochastic Testing with Input Modification for Unbiased Learning Systems. </span> </a> </li> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#user-guide class=md-nav__link> <span class=md-ellipsis> User guide </span> </a> <nav class=md-nav aria-label="User guide"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#repository-organization class=md-nav__link> <span class=md-ellipsis> Repository organization </span> </a> </li> <li class=md-nav__item> <a href=#data-encoding class=md-nav__link> <span class=md-ellipsis> Data encoding </span> </a> </li> <li class=md-nav__item> <a href=#expected-data-format class=md-nav__link> <span class=md-ellipsis> Expected data format </span> </a> </li> <li class=md-nav__item> <a href=#connecting-encoders-and-datasets class=md-nav__link> <span class=md-ellipsis> Connecting encoders and datasets </span> </a> </li> <li class=md-nav__item> <a href=#loading-the-data class=md-nav__link> <span class=md-ellipsis> Loading the data </span> </a> </li> <li class=md-nav__item> <a href=#data-transformation class=md-nav__link> <span class=md-ellipsis> Data transformation </span> </a> </li> <li class=md-nav__item> <a href=#connecting-transformations-and-dataset class=md-nav__link> <span class=md-ellipsis> Connecting transformations and dataset </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#installation class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=#citations class=md-nav__link> <span class=md-ellipsis> citations </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/mathysgrapotte/stimulus-py/edit/main/docs/index.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/mathysgrapotte/stimulus-py/raw/main/docs/index.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=stimulus>STIMULUS<a class=headerlink href=#stimulus title="Permanent link">&para;</a></h1> <h2 id=stochastic-testing-with-input-modification-for-unbiased-learning-systems>Stochastic Testing with Input Modification for Unbiased Learning Systems.<a class=headerlink href=#stochastic-testing-with-input-modification-for-unbiased-learning-systems title="Permanent link">&para;</a></h2> <p><a href="https://github.com/mathysgrapotte/stimulus-py/actions?query=workflow%3Aci"><img alt=ci src=https://github.com/mathysgrapotte/stimulus-py/workflows/ci/badge.svg></a> <a href=https://mathysgrapotte.github.io/stimulus-py/ ><img alt=documentation src="https://img.shields.io/badge/docs-mkdocs-708FCC.svg?style=flat"></a> <a href=https://nfcore.slack.com/channels/deepmodeloptim><img alt="Build with us on slack!" src="http://img.shields.io/badge/slack-nf--core%20%23deepmodeloptim-4A154B?labelColor=000000&logo=slack"></a></p> <!-- [![pypi version](https://img.shields.io/pypi/v/stimulus-py.svg)](https://pypi.org/project/stimulus-py/) --> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p> This package is in active development and breaking changes may occur. The API is not yet stable and features might be added, modified, or removed without notice. Use in production environments is not recommended at this stage.</p> <p>We encourage you to:</p> <ul> <li> <p>ğŸ“ Report bugs and issues on our <a href=https://github.com/mathysgrapotte/stimulus-py/issues>GitHub Issues</a> page</p> </li> <li> <p>ğŸ’¡ Suggest features and improvements through <a href=https://github.com/mathysgrapotte/stimulus-py/discussions>GitHub Discussions</a></p> </li> <li> <p>ğŸ¤ Contribute by submitting pull requests</p> </li> </ul> <p>We are actively working towards release 1.0.0 (see <a href=https://github.com/mathysgrapotte/stimulus-py/milestone/1>milestone</a>), check the slack channel by clicking on the badge above where we are actively discussing. Build with us every wednesday at 14:00 CET until 18:00 CET on the nf-core gathertown (see slack for calendar updates i.e. some weeks open dev hours are not possible)</p> </div> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>Most (if not all) quality software is thouroughly tested. Deep neural networks seem to have escaped this paradigm. </p> <p>In the age of large-scale deep learning, it is critical that early-stage dl models (prototypes) are tested to ensure costly bugs do not happen at scale.</p> <p>Here, we attempt at solving the testing problem by proposing an extensive library to test deep neural networks beyond test-set performance. </p> <p>Stimulus provides those functionalities</p> <ol> <li> <p><strong>Data Perturbation Testing</strong>:<br> Modify training data to test model's robustness to perturbations and uncover which pre-processing steps increase performance</p> </li> <li> <p><strong>Hyperparameter Optimization</strong>:<br> Perform tuning on model architecture with user-defined search spaces using Ray[tune] to ensure comparable performance across data transformations</p> </li> <li> <p><strong>Comprehensive Analysis</strong>:<br> Generate all-against-all model report to guide data pre-processing decisions</p> </li> </ol> <p>For large scale experiments, we recommend our <a href=https://nf-co.re>nf-core</a> <a href=https://github.com/nf-core/deepmodeloptim>deepmodeloptim</a> pipeline which is still under development and will be released alongside stimulus v1.0.0.</p> <p>ğŸ“¹ Stimulus was featured at the nextflow summit 2024 in Barcelona, which is a nice intoduction to current package capabilities, you can watch the talk <a href="https://www.youtube.com/watch?v=dC5p_tXQpEs">here</a></p> <p>Stimulus aims at providing those functionalities in a near future, stay tuned for updates!</p> <ol> <li> <p><strong>Model Architecture Testing</strong>:<br> Run routine checks on model architecture and training process including type-checking, model execution, and weight updates</p> </li> <li> <p><strong>Post-Training Validation</strong>:<br> Perform comprehensive model validation including overfitting detection and out-of-distribution performance testing</p> </li> <li> <p><strong>Informed Hyperparameter Tuning</strong>:<br> Encourage tuning strategies that follow <a href=https://github.com/google-research/tuning_playbook>Google's Deep Learning Tuning Playbook</a> <sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup></p> </li> <li> <p><strong>Scaling Analysis</strong>:<br> Generate scaling law reports to understand prototype model behavior at different scales</p> </li> </ol> <h2 id=user-guide>User guide<a class=headerlink href=#user-guide title="Permanent link">&para;</a></h2> <h3 id=repository-organization>Repository organization<a class=headerlink href=#repository-organization title="Permanent link">&para;</a></h3> <p>Stimulus is organized as follows, we will reference to this structure in the following sections</p> <div class=highlight><pre><span></span><code>src/stimulus/ ğŸ§ª
â”œâ”€â”€ analysis/ ğŸ“Š
â”‚   â””â”€â”€ analysis_default.py
â”œâ”€â”€ cli/ ğŸ–¥ï¸
â”‚   â”œâ”€â”€ analysis_default.py
â”‚   â”œâ”€â”€ check_model.py
â”‚   â”œâ”€â”€ interpret_json.py
â”‚   â”œâ”€â”€ predict.py
â”‚   â”œâ”€â”€ shuffle_csv.py
â”‚   â”œâ”€â”€ split_csv.py
â”‚   â”œâ”€â”€ split_yaml.py
â”‚   â”œâ”€â”€ transform_csv.py
â”‚   â””â”€â”€ tuning.py
â”œâ”€â”€ data/ ğŸ“
â”‚   â”œâ”€â”€ csv.py
â”‚   â”œâ”€â”€ experiments.py
â”‚   â”œâ”€â”€ handlertorch.py
â”‚   â”œâ”€â”€ encoding/ ğŸ”
â”‚   â”‚   â””â”€â”€ encoders.py
â”‚   â”œâ”€â”€ splitters/ âœ‚ï¸
â”‚   â”‚   â””â”€â”€ splitters.py
â”‚   â””â”€â”€ transform/ ğŸ”„
â”‚       â””â”€â”€ data_transformation_generators.py
â”œâ”€â”€ learner/ ğŸ§ 
â”‚   â”œâ”€â”€ predict.py
â”‚   â”œâ”€â”€ raytune_learner.py
â”‚   â””â”€â”€ raytune_parser.py
â””â”€â”€ utils/ ğŸ› ï¸
    â”œâ”€â”€ json_schema.py
    â”œâ”€â”€ launch_utils.py
    â”œâ”€â”€ performance.py
    â””â”€â”€ yaml_model_schema.py
</code></pre></div> <h3 id=data-encoding>Data encoding<a class=headerlink href=#data-encoding title="Permanent link">&para;</a></h3> <p>Data in stimulus can take many forms (files, text, images, networks...) in order to support this diversity, stimulus relies on the <a href=https://mathysgrapotte.github.io/stimulus-py/reference/stimulus/data/encoding/encoders/#stimulus.data.encoding.encoders.AbstractEncoder>encoding module</a>. List of available encoders can be found <a href=https://mathysgrapotte.github.io/stimulus-py/reference/stimulus/data/encoding/encoders/#stimulus.data.encoding.encoders>here</a>.</p> <p>If the provided encoders do not support the type of data you are working with, you can write your own encoder by inheriting from the <code>AbstractEncoder</code> class and implementing the <code>encode</code>, <code>decode</code> and <code>encode_all</code> methods. </p> <ul> <li><code>encode</code> is currently optional, can return a <code>NotImplementedError</code> if the encoder does not support encoding a single data point</li> <li><code>decode</code> is currently optional, can return a <code>NotImplementedError</code> if the encoder does not support decoding</li> <li><code>encode_all</code> is called by other stimulus functions, and is expected to return a <a href=https://numpy.org/doc/stable/reference/generated/numpy.array.html><code>np.array</code></a> . </li> </ul> <h3 id=expected-data-format>Expected data format<a class=headerlink href=#expected-data-format title="Permanent link">&para;</a></h3> <p>Data is expected to be presented in a csv samplesheet file with the following format: </p> <table> <thead> <tr> <th>input1:input:input_type</th> <th>input2:input:input_type</th> <th>meta1:meta:meta_type</th> <th>label1:label:label_type</th> <th>label2:label:label_type</th> </tr> </thead> <tbody> <tr> <td>sample1 input1</td> <td>sample1 input2</td> <td>sample1 meta1</td> <td>sample1 label1</td> <td>sample1 label2</td> </tr> <tr> <td>sample2 input1</td> <td>sample2 input2</td> <td>sample2 meta1</td> <td>sample2 label1</td> <td>sample2 label2</td> </tr> <tr> <td>sample3 input1</td> <td>sample3 input2</td> <td>sample3 meta1</td> <td>sample3 label1</td> <td>sample3 label2</td> </tr> </tbody> </table> <p>Columns are expected to follow this name convention : <code>name:type:data_type</code></p> <ul> <li> <p>name corresponds to the column name, this should be the same as input names in model batch definition (see model section for more details)</p> </li> <li> <p>type is either input, meta or label, typically models predict the labels from the input, and meta is used to perform downstream analysis</p> </li> <li> <p>data_type is the column data type.</p> </li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p> This rigid data format is expected to change once we move to release v1.0.0, data types and information will be defined in a yaml config and only column names will be required in the data, see <a href=https://github.com/mathysgrapotte/stimulus-py/issues/24>this github issue</a></p> </div> <h3 id=connecting-encoders-and-datasets>Connecting encoders and datasets<a class=headerlink href=#connecting-encoders-and-datasets title="Permanent link">&para;</a></h3> <p>Once we have our data formated and our encoders ready, we need to explicitly state which encoder is used for which data type. This is done through an experiment class. </p> <p>To understand how experiment classes are used to connect data types and encoders, let's have a look at a minimal DnaToFloat example : </p> <div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>DnaToFloat</span><span class=p>(</span><span class=n>AbstractExperiment</span><span class=p>):</span>
    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>dna</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;encoder&quot;</span><span class=p>:</span> <span class=n>encoders</span><span class=o>.</span><span class=n>TextOneHotEncoder</span><span class=p>(</span><span class=n>alphabet</span><span class=o>=</span><span class=s2>&quot;acgt&quot;</span><span class=p>),</span>
        <span class=p>}</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>float</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;encoder&quot;</span><span class=p>:</span> <span class=n>encoders</span><span class=o>.</span><span class=n>FloatEncoder</span><span class=p>(),</span>
        <span class=p>}</span>
</code></pre></div> <p>Here we define the <code>data_type</code> for the dna and float types, note that those <code>data_type</code> are the same as the ones defined in the samplesheet dataset above, for example, a dataset on which this experiment would run could look like this: </p> <table> <thead> <tr> <th>mouse_dna:input:dna</th> <th>mouse_rnaseq:label:float</th> </tr> </thead> <tbody> <tr> <td>ACTAGGCATGCTAGTCG</td> <td>0.53</td> </tr> <tr> <td>ACTGGGGCTAGTCGAA</td> <td>0.23</td> </tr> <tr> <td>GATGTTCTGATGCT</td> <td>0.98</td> </tr> </tbody> </table> <p>Note how the <code>data_type</code> for the mouse_dna and mouse_rnaseq columns match exactly the attribute names defined in the <code>DnaToFloat</code> minimal class above. </p> <p>stimulus-py ships with a few basic experiment classes, if you need to write your own experiment class, simply inherit from the base <code>AbstractExperiment</code> class and overwrite the class <code>__init__</code> method like shown above.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p> This has the drawback of requiring a build of the experiment class each time a new task is defined (for instance, let's say we want to use dna and protein sequences to predict rna).</p> <p>Once we move to release v1.0.0, <code>type</code> (i.e. input, meta, label) and <code>data_type</code> will be defined in the data yaml config, and the relevant experiment class will be automatically built.</p> </div> <h3 id=loading-the-data>Loading the data<a class=headerlink href=#loading-the-data title="Permanent link">&para;</a></h3> <p>Finally, once we have defined our encoders, the experiment class and the samplesheet, stimulus will transparently load the data using the <a href=https://mathysgrapotte.github.io/stimulus-py/reference/stimulus/data/csv/#stimulus.data.csv>csv.py module</a></p> <p>csv.py contains two important classes, <code>CsvLoader</code> and <code>CsvProcessing</code></p> <p><code>CsvLoader</code> is responsible for naÃ¯vely loading the data (without changing anything), it works by performing a couple of checks on the dataset to ensure it is correctly formated, and then uses the experiment class in conjunction with the column names to call the proper encoders and output inputs, labels, and meta dictionary objects. </p> <p><code>CsvLoader</code> is used by the <code>handlertorch</code> module to load data into pytorch tensors. </p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p> So, to recap, when you load a dataset into a torch tensor, </p> <ol> <li> <p><code>handlertorch</code> will call <code>CsvLoader</code> with the csv samplesheet and the experiment class</p> </li> <li> <p><code>CsvLoader</code> will use the experiment class to fetch the proper encoder <code>encode_all</code> method for each data column</p> </li> <li> <p><code>CsvLoader</code> will use the <code>encode_all</code> method to encode the data and output dictionary objects for inputs, labels and meta data</p> </li> <li> <p><code>handlertorch</code> will convert the contents to torch tensors</p> </li> <li> <p><code>handlertorch</code> will feed the <code>input</code> torch tensor to the model, use the <code>label</code> torch tensor for loss computation and will store the <code>meta</code> tensor for downstream analysis</p> </li> </ol> <p>Great, now you know how stimulus transparently loads your data into your pytorch model! While this seems complicated, the only thing you really have to do, is to format your data correctly in a csv samplesheet and define your experiment class with the proper encoders (either by using the provided encoders or by writing your own).</p> </div> <h3 id=data-transformation>Data transformation<a class=headerlink href=#data-transformation title="Permanent link">&para;</a></h3> <p>Measuring the impact of data transformations (noising, down/upsampling, augmentation...) on models at training time is a major feature of stimulus.</p> <p>Data transformations materialize as <code>DataTransformer</code> classes, and should inherit from the <code>AbstractDataTransformer</code> class (see <a href=https://mathysgrapotte.github.io/stimulus-py/reference/stimulus/data/encoding/encoders/#stimulus.data.encoding.encoders.AbstractEncoder>docs</a>)</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p> Writing your own <code>DataTransformer</code> class is the same as writing your own <code>Encoder</code> class, you should overwrite the <code>transform</code> and <code>transform_all</code> methods</p> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p> Every <code>DataTransformer</code> class has to have <code>seed</code> in <code>transform</code> and <code>transform_all</code> methods parameters, and <code>np.random.seed(seed)</code> should be called in those methods.</p> </div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p> Every <code>DataTransformer</code> class should have an <code>add_row</code> argument set to either <code>True</code> or <code>False</code> depending on if it is augmenting the data (adding rows) or not.</p> </div> <h3 id=connecting-transformations-and-dataset>Connecting transformations and dataset<a class=headerlink href=#connecting-transformations-and-dataset title="Permanent link">&para;</a></h3> <p>Just like encoders, data transformations are defined in the <code>Experiment</code> class alongside encoders. Let's upgrade our <code>DnaToFloat</code> minimal class defined above to reflect this.</p> <div class=highlight><pre><span></span><code><span class=k>class</span><span class=w> </span><span class=nc>DnaToFloat</span><span class=p>(</span><span class=n>AbstractExperiment</span><span class=p>):</span>
    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=kc>None</span><span class=p>:</span>
        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>dna</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;encoder&quot;</span><span class=p>:</span> <span class=n>encoders</span><span class=o>.</span><span class=n>TextOneHotEncoder</span><span class=p>(</span><span class=n>alphabet</span><span class=o>=</span><span class=s2>&quot;acgt&quot;</span><span class=p>),</span>
            <span class=s2>&quot;data_transformation_generators&quot;</span><span class=p>:</span> <span class=p>{</span>
                <span class=s2>&quot;UniformTextMasker&quot;</span><span class=p>:</span> <span class=n>data_transformation_generators</span><span class=o>.</span><span class=n>UniformTextMasker</span><span class=p>(</span><span class=n>mask</span><span class=o>=</span><span class=s2>&quot;N&quot;</span><span class=p>),</span>
                <span class=s2>&quot;ReverseComplement&quot;</span><span class=p>:</span> <span class=n>data_transformation_generators</span><span class=o>.</span><span class=n>ReverseComplement</span><span class=p>(),</span>
                <span class=s2>&quot;GaussianChunk&quot;</span><span class=p>:</span> <span class=n>data_transformation_generators</span><span class=o>.</span><span class=n>GaussianChunk</span><span class=p>(),</span>
            <span class=p>},</span>
        <span class=p>}</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>float</span> <span class=o>=</span> <span class=p>{</span>
            <span class=s2>&quot;encoder&quot;</span><span class=p>:</span> <span class=n>encoders</span><span class=o>.</span><span class=n>FloatEncoder</span><span class=p>(),</span>
            <span class=s2>&quot;data_transformation_generators&quot;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&quot;GaussianNoise&quot;</span><span class=p>:</span> <span class=n>data_transformation_generators</span><span class=o>.</span><span class=n>GaussianNoise</span><span class=p>()},</span>
        <span class=p>}</span>
</code></pre></div> <p>As you can see, our <code>data_type</code> arguments get an other field, <code>"data_transformation_generators"</code>, there we can initialize the <code>DataTransformer</code> classes with their relevant parameters. </p> <p>In the <code>csv</code> module, the <code>CsvProcessing</code> class will call the <code>transform_all</code> methods from the classes contained in <code>"data_transformation_generators"</code> based on the column type and a list of transformations. </p> <p>i.e., if we give the <code>["ReverseComplement","GaussianChunk"]</code> list to the <code>CsvProcessing</code> class <code>transform</code> method the data contained in the <code>mouse_dna:input:dna</code> column in our minimal example above will be first reverse complemented and then chunked. </p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p> Recap : To transform your dataset,</p> <ul> <li> <p>define your own <code>DataTransformer</code> class or use one we provide</p> </li> <li> <p>add it to your experiment class</p> </li> <li> <p>load your data through <code>CsvProcessing</code> </p> </li> <li> <p>set a list of transforms</p> </li> <li> <p>call <code>CsvProcessing.transform(transform_list)</code></p> </li> </ul> </div> <h2 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">&para;</a></h2> <p>stimulus is still under development, you can install it from test-pypi by running the following command:</p> <div class=highlight><pre><span></span><code>pip<span class=w> </span>install<span class=w> </span>--index-url<span class=w> </span>https://test.pypi.org/simple/<span class=w> </span>--extra-index-url<span class=w> </span>https://pypi.org/simple<span class=w> </span>stimulus-py<span class=o>==</span><span class=m>0</span>.0.10
</code></pre></div> <h2 id=citations>citations<a class=headerlink href=#citations title="Permanent link">&para;</a></h2> <div class=footnote> <hr> <ol> <li id=fn:1> <p>Godbole, V., Dahl, G. E., Gilmer, J., Shallue, C. J., &amp; Nado, Z. (2023). Deep Learning Tuning Playbook (Version 1.0) [Computer software]. <a href=http://github.com/google-research/tuning_playbook>http://github.com/google-research/tuning_playbook</a>&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> </ol> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-11-05T18:02:24+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-11-05</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-11-05T18:02:24+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-11-05</span> </span> </aside> <!-- Giscus --> <!-- https://squidfunk.github.io/mkdocs-material/setup/adding-a-comment-system/#giscus-integration --> <div id=feedback style="display: none;"> <h2 id=__comments>Feedback</h2> <script src=https://giscus.app/client.js data-repo=mathysgrapotte/stimulus-py data-repo-id="REPLACE WITH REPOSITORY NODE ID" data-category=Documentation data-category-id="REPLACE WITH DISCUSSION CATEGORY ID" data-mapping=pathname data-strict=1 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async>
    </script> <!-- Synchronize Giscus theme with palette --> <script>
        var giscus = document.querySelector("script[src*=giscus]")

        // Set palette on initial load
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
            var theme = palette.color.scheme === "slate"
                ? "transparent_dark"
                : "light"

            // Instruct Giscus to set theme
            giscus.setAttribute("data-theme", theme) 
        }

        // Register event handlers after documented loaded
        document.addEventListener("DOMContentLoaded", function() {
            var ref = document.querySelector("[data-md-component=palette]")
            ref.addEventListener("change", function() {
                var palette = __md_get("__palette")
                if (palette && typeof palette.color === "object") {
                    var theme = palette.color.scheme === "slate"
                        ? "transparent_dark"
                        : "light"

                    // Instruct Giscus to change theme
                    var frame = document.querySelector(".giscus-frame")
                    frame.contentWindow.postMessage(
                        { giscus: { setConfig: { theme } } },
                        "https://giscus.app"
                    )
                }
            })
        })
    </script> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=changelog/ class="md-footer__link md-footer__link--next" aria-label="Next: Changelog"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Changelog </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 Mathys Grapotte </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/mathysgrapotte target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://gitter.im/stimulus-py/community target=_blank rel=noopener title=gitter.im class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 384 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M66.4 322.5H16V0h50.4zM166.9 76.1h-50.4V512h50.4zm100.6 0h-50.4V512h50.4zM368 76h-50.4v247H368z"/></svg> </a> <a href=https://pypi.org/project/stimulus-py/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": ".", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.suggest", "toc.follow"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=assets/javascripts/bundle.60a45f97.min.js></script> <script src=assets/_markdown_exec_pyodide.js></script> <script src=js/timeago.min.js></script> <script src=js/timeago_mkdocs_material.js></script> <script src=js/feedback.js></script> </body> </html>